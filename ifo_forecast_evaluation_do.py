

# --------------------------------------------------------------------------------------------------
# ==================================================================================================
# Title:        
#
# Author:       Jan Ole Westphal
# Date:         2025-
#
# Description:  -            
# ==================================================================================================
# --------------------------------------------------------------------------------------------------





# -------------------------------------------------------------------------------------------------#
# =================================================================================================#
#                                        ~  OPTIONS  ~                                             #
# =================================================================================================#
# -------------------------------------------------------------------------------------------------#


# ==================================================================================================
# PARAMETER Setup:
#
# wd                   Sets the current working directory
# resultfolder_name    Sets the folder name where results of a given run are printed, e.g. 'results',
#                       
# ==================================================================================================


# --------------------------------------------------------------------------------------------------
# Folders and Data
# --------------------------------------------------------------------------------------------------

# Set wd as '/path/to/your/project' or r'\path\to\your\project'
wd = r'C:\Users\janol\OneDrive\Desktop\ifo\Investitionsprojekt f√ºr Lea\Python workfolder'

# Customize Resultfolder names
resultfolder_name = 'Results'  








# -------------------------------------------------------------------------------------------------#
# =================================================================================================#
#                                        Code begins here                                          #
# =================================================================================================#
# -------------------------------------------------------------------------------------------------#



# ==================================================================================================
# SET-UP
# ==================================================================================================

# --------------------------------------------------------------------------------------------------
# Packages
# --------------------------------------------------------------------------------------------------

# Import built-ins
import importlib
import subprocess
import sys
import os
from datetime import datetime, date

# Check for libraries
required_packages = [
    'requests',
    'openpyxl',
    'pandas',
    'pandasgui',
    'numpy',
    'statsmodels',
    'matplotlib',
    'seaborn'
]

# Install if needed
for pkg in required_packages:
    try:
        importlib.import_module(pkg)
    except ImportError:
        subprocess.check_call([sys.executable, "-m", "pip", "install", pkg])
        print(f" {pkg} installed.")

# Import libraries
import requests
import pandas as pd
from pandasgui import show  
import numpy as np
from statsmodels.tsa.ar_model import AutoReg
import matplotlib.pyplot as plt
import seaborn as sns

# Set display options
pd.set_option('display.max_columns', None)
sns.set_theme(style='whitegrid')




# --------------------------------------------------------------------------------------------------
# Working Directory and results folder
# --------------------------------------------------------------------------------------------------

# Set working directory
if wd:
    try:
        os.makedirs(wd, exist_ok=True)
        os.chdir(wd)
        print(f" \nWorking directory set to: {wd} ... \n")
    except FileNotFoundError:
        print(f"Directory not found: {wd} \n")
else:
    print("No working directory set.")



#Define the result_subfolder
result_subfolder = resultfolder_name


# Define Resultfolder path
folder_path = os.path.join(wd, result_subfolder)

# Create the folder if it doesn't exist
os.makedirs(folder_path, exist_ok=True)

"""
# Clear the results folder
for file in os.listdir(folder_path):
    file_path = os.path.join(folder_path, file)
    if os.path.isfile(file_path):
        os.remove(file_path)
"""




# ==================================================================================================
# DATA PROCESSING
# ==================================================================================================

# --------------------------------------------------------------------------------------------------
# Import Data locally
# --------------------------------------------------------------------------------------------------

# Output filename
filename = ''
filepath = os.path.join(wd, filename)

#


# --------------------------------------------------------------------------------------------------
# Reformat into a usable dataframe
# --------------------------------------------------------------------------------------------------



# Inspect
#print(df.head())

print("Raw Data loaded ... \n")


# --------------------------------------------------------------------------------------------------
# Data Cleaning
# --------------------------------------------------------------------------------------------------


# Inspect
#print(df.head())



print("Data cleaned ... \n")




# ==================================================================================================
# MODEL ESTIMATION
# ==================================================================================================


# --------------------------------------------------------------------------------------------------
#  Define necessary functionalities
# --------------------------------------------------------------------------------------------------







# --------------------------------------------------------------------------------------------------
print(f" \n \nProgram complete, results are in Subfolder {result_subfolder} of working directory {wd} \n")
# --------------------------------------------------------------------------------------------------




# -------------------------------------------------------------------------------------------------#
# =================================================================================================#
#                                        End of Code                                               #
# =================================================================================================#
# -------------------------------------------------------------------------------------------------#
